var core=function(a){function b(){g.getData().then(function(){h.sortSubjects(),h.sortArticles(),i.checkLogin(),i.generateMenu(),e.switchTo(e.path()),i.hideLoader()})}var c={dataSource:"http://imgsz/"},d={},e={path:function(){return window.location.pathname},switchTo:function(a){switch(a){case"/admin/manage-subjects":if("1"==d.data.session.user_admin){document.title=h.getTitle()+" | Admin | Manage subjects",i.generateManageSubjects(),i.generateArtSelectables(),i.generateRelatedPreview(),i.manageSectionSetActive("a#manage-subjects");break}e.switchTo("/"),window.history.replaceState("","","/");break;case"/admin/manage-articles":if("1"==d.data.session.user_admin){document.title=h.getTitle()+" | Admin | Manage articles",i.generateManageArticles(),i.generateArtSelectables(),i.generateRelatedPreview(),i.manageSectionSetActive("a#manage-articles");break}e.switchTo("/"),window.history.replaceState("","","/");break;case"/admin/manage-users":if("1"==d.data.session.user_admin){document.title=h.getTitle()+" | Admin | Manage users",i.generateManageUsers(),i.generateArtSelectables(),i.generateRelatedPreview(),i.manageSectionSetActive("a#manage-users");break}e.switchTo("/"),window.history.replaceState("","","/");break;case"":case"/":document.title=h.getTitle()+" | Home",i.generateMain(),i.subjectSetActive("span.icon-home");break;default:-1!=a.indexOf("/")&&(pathArray=a.split("/")),console.log(pathArray);var b=h.getSbjByName(pathArray[1]),c=h.getArtByName(pathArray[2]);if(c)return i.articleSetActive(c,b),i.generateArticleUnit(c.id),h.setArticleTitle(c,b),i.generateArtSelectables(),void i.generateRelatedPreview();if(b)return i.subjectSetActive(b),i.generateSbjArticles(b.id),h.setSubjectTitle(b),i.generateArtSelectables(),void i.generateRelatedPreview();document.title=h.getTitle()+" | Home",i.generateMain(),window.location.pathname="/",i.subjectSetActive("span.icon-home"),console.log("default location switch")}},popState:function(){window.onpopstate=function(a){document.location.hash||e.switchTo(e.path())}}()},f={spinner:function(){return'<span class="icon-span icon-spinner">&#xe982;</span>'},menuItem:function(a){return"<li class='subject-unit' data-sbj-id='"+a.id+"'><a class='menu-item' href=''>"+a.name+"</a></li>"},menuHomeIcon:function(){return'<span class="icon-span icon-home">&#xe900;</span>'},articlePreview:function(a){var b="";return"1"==d.data.session.user_admin&&(b='<div class="admin-art-ctrl"><a href="#article-edit" class="article-edit-btn-p">Edit article</a></div>'),'<div class="row content-block article-unit article-preview" data-art-id="'+a.id+'"><h2><a href="" class="article-title">'+a.title+"</a></h2>"+b+'<p class="art-title-desc"> by <span class="user-unit" data-user-id="'+a.user_id+'"><a class="art-desc-user" href="#user-profile" >'+a.user_name+'</span></a></p><p class="art-text">'+h.getFirstParagraph(a.content)+'</p><div class= "comments-link"><a href="">Comments ('+a.comments.length+")</a></div></div>"},relatedPreview:{sbjLayout:function(a){return'<div class="related-block subject-unit" data-sbj-id="'+a.id+'"><H3>Last '+a.name+" articles</H3><ul></ul></div>	"},artLayout:function(a){return'<li class="article-unit" data-art-id="'+a.id+'"><a class="article-title" data-art-id="'+a.id+'" href="">'+a.title+"</a></li>"}},loggedIn:function(a){return'<span class="user-unit" data-user-id="'+a.user_id+'">Logged in as: <a class="user-title-head" href="#user-profile">'+a.user_name+"</a> </span>"},userMenu:function(){var a="";return"1"==d.data.session.user_admin&&(a='<li><a id="show-settings" href="#settings">Settings</a></li><li><a id="manage-users" href="">Manage users</a></li><li><a id="manage-articles" href="">Manage articles</a></li><li><a id="manage-subjects" href="">Manage subjects</a></li>'),'<li><a id="logoutBtn" href="">Log out</a></li>'+a},manageArticles:{outLayout:function(){return'<div class="row content-block manage-articles-block"><h2 class="admin-area-title">Manage articles</h2><div class="item-add-new"><a href="#article-new">Add new article</a></div><div id="art-subject-container"></div><div id="art-empty-container" class="art-uncategorized"><ul></ul></div></div>'},sbjLayout:function(a){return'<h3 class="sbj-list-title inner-row">'+a.name+'</h3><div class="manage-articles" data-sbj-id="'+a.id+'"><ul><li data-sbj-id="'+a.id+'" class="row inner-row article-unit sbjLayout-placeholder"><div class="column-s-12"> </div></li></ul></div>'},artLayout:function(a){return'<li class="row inner-row article-unit" data-art-id="'+a.id+'"><div class="column-s-1 column-m-1">id: '+a.id+'</div><div class="column-s-7 column-m-7"><a href="" class="article-title">'+a.title+'</a></div><a href="#article-edit" class="column-s-2 column-m-2 article-edit-btn-ma">Edit</a><a href="#" class="column-s-2 column-m-2 article-delete-btn">Delete</a></li>'},empty:function(a){return'<li data-sbj-id="'+a.id+'" class="row inner-row article-unit sbjLayout-placeholder"><div class="column-s-12"> </div></li>'},selectables:function(a){return'<option value="'+a.id+'">'+a.name+"</option>"}},article:{articleUnit:function(a){var b="",c="";return"1"==d.data.session.user_admin&&(b='<div class="admin-art-ctrl"><a href="#article-edit" class="article-edit-btn-au">Edit article</a></div>'),a.updated_at&&(c="; updated at "+a.updated_at),'<div class="row content-block article-unit" data-art-id="'+a.id+'"><h2>'+a.title+"</h2>"+b+'<p class="art-title-desc">by <span class="user-unit" data-user-id="'+a.user_id+'"><a class="art-desc-user" href="#user-profile">'+a.user_name+"</a></span>, "+a.created_at+c+'</p><p class="art-text">'+h.replaceSpaces(a.content)+'</p><div class="row comments-block"></div></div>'},commentUnit:function(a){var b="";return"1"==d.data.session.user_admin&&(b='<div class="comment-ctrl"><a href="" class="comment-delete-btn">Delete comment</a></div>'),'<div class="comment-unit" data-cmnt-id="'+a.id+'"><div class="comment-body"><div class="comment-header"><span class="user-unit" data-user-id="'+a.user_id+'"><a class="cmnt-desc-user" href="#user-profile">'+a.name+"</a></span><span> at "+a.created_at+"</span>"+b+'</div><div class="comment-text"><p>'+a.content+"</p></div></div></div>"},postComment:function(a){var b="";return d.data.session.user_id&&(b='<div class="row content-block comment-post" data-art-id="'+a.id+'"><label class="cmnt-post-header">Leave a comment:</label><textarea class="cmnt-post-body input-area"></textarea><div class="row"><a href="" class="btn comment-post-btn"> Post comment</a></div></div>'),b}},manageSubjects:{outLayout:function(){return'<div class="row content-block"><h2 class="admin-area-title">Manage subjects</h2><div class="item-add-new"><a href="#subject-new">Add new subject</a></div><div class="manage-subjects"><ul></ul></div>'},sbjLayout:function(a){return'<li class="row inner-row subject-unit" data-sbj-id="'+a.id+'"><div class="column-s-1 column-m-1">id: '+a.id+'</div><div class="column-s-5 column-m-5"><input class="input-area subject-name" type="text" value="'+a.name+'"></div><a href="" class="column-s-3 column-m-3 sbj-rename-btn">Rename</a><a href="" class="column-s-3 column-m-3 sbj-delete-btn">Delete</a></li>'}},manageUsers:{outLayout:function(){return'<div class="row content-block"><h2 class="admin-area-title">Manage users</h2><div class="item-add-new"><a href="#register">Add new user</a></div><div class="manage-users"><ul></ul></div>'},userLayout:function(a){var b,c="";return b="1"==a.admin?"admin":"user",d.data.session.user_id!=a.id&&(c='<a href="" class="column-s-2 column-m-2 user-delete-btn">Delete</a>'),'<li class="row inner-row user-unit" data-user-id="'+a.id+'"><div class="column-s-1 column-m-1">id: '+a.id+'</div><div class="column-s-7 column-m-7"><a href="#user-profile" class="user-title">'+a.name+'</a></div><div class="column-s-2 column-m-2">'+b+"</a></div>"+c+"</li>"}}},g={pool:[],setup:function(){$(document).ajaxSend(function(a,b){g.pool.push(b)}),$(document).ajaxComplete(function(a,b){g.pool=g.pool.filter(function(a){return a!=b}),i.hideSpinner()}),$(document).ajaxStart(function(a){i.showSpinner()})}(),checkAbort:function(){g.pool.length&&g.pool.forEach(function(a){a.abort()})},getData:function(){return g.checkAbort(),$.get(c.dataSource,function(a){return d.data=a,this},"json")},getLogout:function(){return g.checkAbort(),$.get(c.dataSource+"users/logout",function(a){return d.logoutRes=a,this},"json")},postLogin:function(a){return g.checkAbort(),$.post(c.dataSource+"users/login",a,function(a){return this},"json")},postArtAdd:function(a){return g.checkAbort(),$.post(c.dataSource+"articles/add",a,function(a){return this},"json")},postArtEdit:function(a){return g.checkAbort(),$.post(c.dataSource+"articles/edit",a,function(a){return this},"json")},postArtDelete:function(a){return g.checkAbort(),$.post(c.dataSource+"articles/delete",a,function(a){return this},"json")},postComment:function(a){return g.checkAbort(),$.post(c.dataSource+"comments/add",a,function(a){return this},"json")},postCmntDelete:function(a){return g.checkAbort(),$.post(c.dataSource+"comments/delete",a,function(a){return this},"json")},postSbjDelete:function(a){return g.checkAbort(),$.post(c.dataSource+"subjects/delete",a,function(a){return this},"json")},postSbjAdd:function(a){return g.checkAbort(),$.post(c.dataSource+"subjects/add",a,function(a){return this},"json")},postSbjEdit:function(a){return g.checkAbort(),$.post(c.dataSource+"subjects/edit",a,function(a){return this},"json")},postUserDelete:function(a){return g.checkAbort(),$.post(c.dataSource+"users/delete",a,function(a){return this},"json")},postUserAdd:function(a){return g.checkAbort(),$.post(c.dataSource+"users/add",a,function(a){return this},"json")},postUserEdit:function(a){return g.checkAbort(),$.post(c.dataSource+"users/set_admin",a,function(a){return this},"json")},getDummy:function(){return g.checkAbort(),$.get(c.dataSource+"dummies/get_dummy",function(a){return this},"json")},postTitle:function(a){return g.checkAbort(),$.post(c.dataSource+"desc/set_title",a,function(a){return this},"json")}},h={sortSubjects:function(){d.data.subjects.sort(function(a,b){return a.id-b.id})},sortArticles:function(){d.data.articles.sort(function(a,b){return b.id-a.id})},getFirstParagraph:function(a){return-1!=a.indexOf("\n")&&(a=a.split("\n").shift()),a},replaceSpaces:function(a){return a=a.replace(/\n/g,"<br>")},getLoginVal:function(){return{name:$("input#login-user").val().trim(),password:$("input#login-pass").val().trim()}},getNewUserVal:function(){return{name:$("input#user-input-name").val().trim(),password:$("input#user-input-name").val().trim()}},getArtEditVal:function(a){return d.data.session.user_id?{article_title:$("input#art-"+a+"-title").val().trim(),article_content:$("textarea#art-"+a+"-content").val().trim(),article_subject_id:$("select#art-"+a+"-subject_id").val(),article_user_id:d.data.session.user_id}:!1},getArtId:function(a){return{article_id:$(a).parents(".article-unit, .content-block").data("art-id")}},getArtById:function(a){var b=d.data.articles.filter(function(b){return b.id==a})[0];return b},getArtByName:function(a){if(a){a=a.replace(/\_+/g," ");var b=d.data.articles.filter(function(b){return b.title.toLowerCase()==a})[0];return b}},getCmntId:function(a){return{comment_id:$(a).parents(".comment-unit").data("cmnt-id")}},getCmntVal:function(a){return{comment_content:$("textarea.cmnt-post-body").val().trim(),comment_user_id:d.data.session.user_id}},getSbjId:function(a){return{subject_id:$(a).parents(".subject-unit").data("sbj-id")}},getSbjNewVal:function(){return{subject_name:$("input#subject-newname").val().trim()}},getSbjVal:function(a){return{subject_name:$("li.subject-unit[data-sbj-id='"+a+"'] .subject-name").val().trim()}},getSbjById:function(a){var b=d.data.subjects.filter(function(b){return b.id==a})[0];return b},getSbjByName:function(a){var b=d.data.subjects.filter(function(b){return b.name.toLowerCase()==a})[0];return b},getUserId:function(a){return{user_id:$(a).parents(".user-unit").data("user-id")}},getUserEditVal:function(){return{user_admin:$("select#user-profile-admin").val()}},getTitle:function(){return d.site_title?d.site_title:(d.site_title=$("title").first().text(),d.site_title)},getTitleEditVal:function(){return{site_title:$("input#title-name").val().trim()}},deleteSubject:function(a){d.data.subjects.forEach(function(b,c,d){b.id==a&&d.splice(c,1)}),d.data.articles.forEach(function(b){b.subject_id==a&&(b.subject_id=null)}),i.generateArtSelectables(),$("[data-sbj-id='"+a+"']").remove()},deleteArticle:function(a){var b;d.data.articles.forEach(function(c,d,e){c.id==a&&(b=c.subject_id,e.splice(d,1))}),$("[data-art-id='"+a+"']").remove(),h.checkLastArtList(b),i.generateRelatedPreview()},checkLastArtList:function(a){var b=h.getSbjById(a);b&&$("div.manage-articles[data-sbj-id='"+b.id+"'] ul").is(":empty")&&$("div.manage-articles[data-sbj-id='"+b.id+"'] ul").append(f.manageArticles.empty(b.id))},deleteComment:function(a,b){console.log(a,b),d.data.articles.forEach(function(c){a.article_id==c.id&&c.comments.forEach(function(a,c,d){b.id==a.id&&d.splice(c,1)})}),i.deleteComment(b.id)},deleteUser:function(a){d.data.users.forEach(function(b,c,d){b.id==a&&d.splice(c,1),i.deleteUser(a)})},addSubjects:function(a){d.data.subjects.push(a),h.updateSubjects()},updateSubjects:function(){$("nav.menu ul").empty(),i.generateMenu(),i.generateManageSubjects(),i.generateArtSelectables(),i.generateRelatedPreview()},editSubjects:function(a){d.data.subjects.forEach(function(b){return a.id==b.id?(b.name=a.name,void h.updateSubjects()):void 0})},editArticles:function(a){d.data.articles.forEach(function(b){return a.id==b.id?(b.title=a.title,b.content=a.content,b.subject_id=a.subject_id,b.user_id=a.user_id,$("div.article-unit[data-art-id='"+b.id+"']:not('.article-preview')").length&&i.generateArticleUnit(b.id),$("div.article-preview[data-art-id='"+b.id+"']").replaceWith(f.articlePreview(b)),$("div.manage-articles-block").length&&i.generateManageArticles(),void i.generateRelatedPreview()):void 0})},editUsers:function(a){d.data.users.forEach(function(b,c,d){return a.id==b.id?void(d[c].admin=a.admin):void 0}),i.generateManageUsers()},addArticles:function(a){d.data.articles.unshift(a),i.generateManageArticles(),i.generateRelatedPreview()},updateManageUsers:function(a){"1"==d.data.session.user_admin&&(d.data.users.push(a),i.generateManageUsers())},setSubjectTitle:function(a){document.title=h.getTitle()+" | "+a.name},setArticleTitle:function(a,b){document.title=h.getTitle()+" | "+b.name+" | "+a.title}},i={generateMenu:function(){$("nav.menu ul").append(f.menuHomeIcon()),d.data.subjects.forEach(function(a){$("nav.menu ul").append(f.menuItem(a))})},checkLogin:function(){d.data.session.user_name?($("div.login-block").empty().append(f.loggedIn(d.data.session)),$("div.admin-menu ul").append(f.userMenu()),"1"!=d.data.session.user_admin&&$("div#article-new, div#article-edit, div#subject-new, div#settings, div#register, div#login").remove()):$("div#article-new, div#article-edit, div#subject-new, div#settings").remove()},generateArtPreview:function(){d.data.articles.forEach(function(a){a.subject_id&&$("div.content-left").append(f.articlePreview(a))})},generateManageArticles:function(){$("div.content-left").empty().append(f.manageArticles.outLayout()),d.data.subjects.length?(d.data.subjects.forEach(function(a){$("div#art-subject-container").append(f.manageArticles.sbjLayout(a)),d.data.articles.forEach(function(b){a.id==b.subject_id&&($("li.sbjLayout-placeholder[data-sbj-id='"+a.id+"']").remove(),$("div.manage-articles[data-sbj-id='"+a.id+"'] ul").append(f.manageArticles.artLayout(b)))}),h.checkLastArtList(a.id)}),d.data.articles.forEach(function(a){null===a.subject_id&&$("div#art-empty-container ul").append(f.manageArticles.artLayout(a))})):d.data.articles.length&&d.data.articles.forEach(function(a){$("div#art-empty-container ul").append(f.manageArticles.artLayout(a))})},generateArtSelectables:function(){$("select#art-add-subject_id").empty(),$("select#art-edit-subject_id").empty(),d.data.subjects.forEach(function(a){$("select#art-add-subject_id").append(f.manageArticles.selectables(a)),$("select#art-edit-subject_id").append(f.manageArticles.selectables(a))})},generateArtEditData:function(a){var b=d.data.articles.filter(function(b){return b.id==a})[0];b&&($("input#art-edit-title").val(b.title),$("textarea#art-edit-content").val(b.content),$("select#art-edit-subject_id").val(b.subject_id))},deleteMngArticlesListItem:function(a){$(".article-unit[data-art-id='"+a+"']").remove()},generateArticleUnit:function(a){var b=d.data.articles.filter(function(b){return b.id==a})[0];$("div.content-left").empty().append(f.article.articleUnit(b)),b.comments&&b.comments.forEach(function(a){$("div.comments-block").append(f.article.commentUnit(a))}),$("div.content-left").append(f.article.postComment(b))},deleteComment:function(a){$(".comment-unit[data-cmnt-id='"+a+"']").remove()},generateManageSubjects:function(){$("div.content-left").empty().append(f.manageSubjects.outLayout()),d.data.subjects.forEach(function(a){$("div.manage-subjects ul").append(f.manageSubjects.sbjLayout(a))})},generateSbjArticles:function(a){$("div.content-left").empty(),d.data.articles.forEach(function(b){b.subject_id==a&&$("div.content-left").append(f.articlePreview(b))})},generateRelatedPreview:function(){$("div.content-right").empty(),d.data.subjects.forEach(function(a){var b=d.data.articles.filter(function(b){return b.subject_id==a.id});if(b.length){$("div.content-right").append(f.relatedPreview.sbjLayout(a));for(var c=0;3>c&&b[c];c++)$("div.related-block[data-sbj-id='"+a.id+"'] ul").append(f.relatedPreview.artLayout(b[c]))}})},generateMain:function(){$("div.content-left, div.content-right").empty(),i.generateArtPreview(),i.generateArtSelectables(),i.generateRelatedPreview()},generateManageUsers:function(){$("div.content-left").empty().append(f.manageUsers.outLayout()),d.data.users.forEach(function(a){$("div.manage-users ul").append(f.manageUsers.userLayout(a))})},generateUserData:function(a){var b=d.data.users.filter(function(b){return b.id==a})[0];$("span#user-profile-name").text(b.name),b.id!=d.data.session.user_id&&"1"==d.data.session.user_admin?(console.log(b),$("div.user-profile-admin-section").show(),$("select#user-profile-admin").val(b.admin)):(console.log("no"),$("div.user-profile-admin-section").hide())},deleteUser:function(a){$(".user-unit[data-user-id='"+a+"']").remove()},subjectSetActive:function(a){a.id?sbjNode=$("li.subject-unit[data-sbj-id='"+a.id+"'] a"):sbjNode=a,$(".active").removeClass("active"),$("div.content-right li.article-unit").find(".active").removeClass("active"),$(sbjNode).addClass("active")},articleSetActive:function(a,b){artNode=$("li.article-unit[data-art-id='"+a.id+"'] a"),sbjNode=$("li.subject-unit[data-sbj-id='"+b.id+"'] a"),$(".active").removeClass("active"),$(artNode).addClass("active"),$(sbjNode).addClass("active")},manageSectionSetActive:function(a){$(".active").removeClass("active"),$(a).addClass("active")},hideLoader:function(){$("div.loader").hide()},showLoader:function(){$("div.loader").show()},showSpinner:function(){$("div.logo").html(f.spinner())},hideSpinner:function(){$("div.logo").text("LOGO")},setTitleSettings:function(){$("input#title-name").val(h.getTitle())}};({login:function(){$("a#loginBtn").on("click",function(a){a.preventDefault(),g.postLogin(h.getLoginVal()).then(function(){window.history.replaceState("","",window.location.pathname),window.location.reload()})})}(),logout:function(){$("ul").on("click","a#logoutBtn",function(a){a.preventDefault(),g.getLogout(),window.location.reload()})}(),userCreate:function(){$("a#user-new-btn").on("click",function(a){a.preventDefault();var b;console.log("lol"),b=h.getNewUserVal(),""!==b.name&&""!==b.password&&g.postUserAdd(b).then(function(a){d.data.session.user_id?(h.updateManageUsers(a),location.hash="#",window.history.replaceState("","",window.location.pathname)):(console.log(h.getNewUserVal()),g.postLogin(h.getNewUserVal()).then(function(){location.hash="#",window.history.replaceState("","",window.location.pathname),window.location.reload()}))})})}(),switchToManageArticles:function(){$("ul").on("click","a#manage-articles",function(a){a.preventDefault(),document.title=h.getTitle()+" | Admin | Manage articles",i.generateManageArticles(),"/admin/manage-articles"!=e.path()&&window.history.pushState({page:"/admin/manage-articles"},"manage-articles","/admin/manage-articles"),i.manageSectionSetActive(this)})}(),articleAdd:function(){$("#art-add-save-btn").on("click",function(a){a.preventDefault();var b=h.getArtEditVal("add");""!==b.article_title&&""!==b.article_content&&(g.postArtAdd(b).then(function(a){h.addArticles(a)}),location.hash="#",window.history.replaceState("","",window.location.pathname))})}(),articleEditData:function(){$("div.content-left").on("click","a.article-edit-btn-ma, a.article-edit-btn-p, a.article-edit-btn-au",function(a){d.editedArticle=h.getArtId(this),i.generateArtEditData(d.editedArticle.article_id)})}(),articleEdit:function(){$("#art-edit-save-btn").on("click",function(a){a.preventDefault();var b=h.getArtEditVal("edit");""!==b.article_title&&""!==b.article_content&&(b.article_updated="1",d.editedArticle&&(b.article_id=d.editedArticle.article_id,g.postArtEdit(b).then(function(a){h.editArticles(a)}),d.editedArticle=null),location.hash="#",window.history.replaceState("","",window.location.pathname))})}(),articleDelete:function(){$("div.content-left").on("click","a.article-delete-btn",function(a){a.preventDefault();var b=h.getArtId(this);g.postArtDelete(b).then(function(){h.deleteArticle(b.article_id)})})}(),articleShowUnit:function(){$("div.content-left, div.content-right").on("click","a.article-title, div.comments-link a ",function(a){a.preventDefault();var b=h.getArtId(this);i.generateArticleUnit(b.article_id);var c=h.getArtById(b.article_id),d=h.getSbjById(c.subject_id);h.setArticleTitle(c,d);var f=c.title.replace(/\s+/g,"_");e.path()!="/"+d.name.toLowerCase()+"/"+f.toLowerCase()&&window.history.pushState({page:"/"+d.name+"/"+f},f,"/"+d.name.toLowerCase()+"/"+f.toLowerCase()),i.articleSetActive(c,d)})}(),commentPost:function(){$("div.content-left").on("click","a.comment-post-btn",function(a){a.preventDefault();var b=h.getArtId(this),c=h.getCmntVal();""!==c.comment_content&&(c.comment_article_id=b.article_id,g.postComment(c).then(function(a){d.data.articles.forEach(function(b){return a.article_id==b.id?(b.comments.push(a),void i.generateArticleUnit(b.id)):void 0})}))})}(),commentDelete:function(){$("div.content-left").on("click","a.comment-delete-btn",function(a){a.preventDefault();var b=h.getCmntId(this),c=h.getArtId(this);g.postCmntDelete(b).then(function(a){console.log(a),h.deleteComment(c,a)})})}(),switchToManageSubjects:function(){$("ul").on("click","a#manage-subjects",function(a){a.preventDefault(),document.title=h.getTitle()+" | Admin | Manage subjects",i.generateManageSubjects(),"/admin/manage-subjects"!=e.path()&&window.history.pushState({page:"/admin/manage-subjects"},"manage-subjects","/admin/manage-subjects"),i.manageSectionSetActive(this)})}(),subjectDelete:function(){$("div.content-left").on("click","a.sbj-delete-btn",function(a){a.preventDefault();var b=h.getSbjId(this);g.postSbjDelete(b).then(function(){h.deleteSubject(b.subject_id)})})}(),subjectAdd:function(){$("#sbj-add-save-btn").on("click",function(a){a.preventDefault();var b=h.getSbjNewVal();b.subject_name&&(g.postSbjAdd(b).then(function(a){h.addSubjects(a)}),location.hash="#",window.history.replaceState("","",window.location.pathname))})}(),subjectEdit:function(){$("div.content-left").on("click","a.sbj-rename-btn",function(a){a.preventDefault();var b=h.getSbjId(this);b.subject_name=h.getSbjVal(b.subject_id).subject_name,""!==b.subject_name&&g.postSbjEdit(b).then(function(a){h.editSubjects(a)})})}(),subjectShow:function(){$("div.menu-block").on("click","a.menu-item",function(a){a.preventDefault();var b=h.getSbjId(this);i.generateSbjArticles(b.subject_id);var c=h.getSbjById(b.subject_id);h.setSubjectTitle(c),e.path()!="/"+c.name.toLowerCase()&&window.history.pushState({page:"/"+c.name},c.name,"/"+c.name.toLowerCase()),i.subjectSetActive(c)})}(),switchToManageUsers:function(){$("ul").on("click","a#manage-users",function(a){a.preventDefault(),document.title=h.getTitle()+" | Admin | Manage users",i.generateManageUsers(),"/admin/manage-users"!=e.path()&&window.history.pushState({page:"/admin/manage-users"},"manage-users","/admin/manage-users"),i.manageSectionSetActive(this)})}(),userDelete:function(){$("div.content-left").on("click","a.user-delete-btn",function(a){a.preventDefault();var b=h.getUserId(this);g.postUserDelete(b).then(function(){h.deleteUser(b.user_id)})})}(),userEditData:function(){$("div.content-left, div.login-block").on("click","a.user-title, a.user-title-head, a.art-desc-user, a.cmnt-desc-user",function(a){var b=h.getUserId(this);console.log(b),d.editedUser=b,i.generateUserData(b.user_id)})}(),userEdit:function(){$("section.wrapper").on("click","a#user-profile-save-btn",function(a){a.preventDefault();var b=h.getUserEditVal();d.editedUser&&(b.user_id=d.editedUser.user_id,g.postUserEdit(b).then(function(a){h.editUsers(a)}),d.editedArticle=null),location.hash="#",window.history.replaceState("","",window.location.pathname)})}(),homePage:function(){$("div.menu-block").on("click","span.icon-home",function(a){document.title=h.getTitle()+" | Home",i.generateMain(),window.history.pushState({page:"index"},"index","/"),i.subjectSetActive(this)})}(),hideHash:function(){$("a.modal-close").on("click",function(a){a.preventDefault(),location.hash="#",window.history.replaceState("","",window.location.pathname)})}(),showSettings:function(){$("section.wrapper").on("click","a#show-settings",function(a){i.setTitleSettings()})}(),wipeDataGetDummy:function(){$("section.wrapper").on("click","a#wipe-get-dummy",function(a){g.getDummy().then(function(){window.history.pushState({page:"index"},"index","/"),window.location.reload(!0)})})}(),titleEdit:function(){$("section.wrapper").on("click","a#title-edit",function(a){var b=h.getTitleEditVal();""!==b.site_title&&g.postTitle(b).then(function(){window.history.pushState({page:"index"},"index","/"),window.location.reload(!0)})})}()});return $(document).ready(function(){b()}),{}}({});
//# sourceMappingURL=../maps/js/main.js.map